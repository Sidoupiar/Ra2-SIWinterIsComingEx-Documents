# 待办事项 v0.0.9

## 已准备添加的功能

### 这里列出已经确定确实可以加上的功能，它们会被陆续添加到平台扩展中。

### 标记逻辑

* 替代武器标记。

* 自瞄武器标记。

## 可能会添加的功能

### 由于不确定是否可以加得上的功能，以及暂时没有合适的解决方案的功能会列在此处。一旦这些功能获得了合适的解决方案，就会被添加到平台扩展中。

### 标记逻辑

* 所有带弹头的标记增加直接扣血的可选效果。

* 标记所属作战方，加个是否固定不变的功能。  
即不论单位所属的作战方如何变化，始终为附加瞬间的作战方。

* 揭示黑幕标记。

* 扩散连锁标记。

* 扩散弹头（抛射体）标记。

* 记录单位类型标记。

* 医院和医院成员标记（自定义医院）。

* 除你武器标记。

* 逆分摊标记。

* 广播标记。  
广播动画，自身位置播放的动画，收到广播的单位处播放的动画。  
广播半径、广播间隔、广播次数、广播的持续时间。  
根据自身持有的标记、血量、强度值等效果，决定是否生效。

* 弹药标记。  
使携带该标记的单位，在每次触发时使弹药增加或减少一定数值。  
当弹药超过 A 或低于 B 时均会禁用指定的武器（会尝试切换为另一个可使用的武器攻击）。  
当弹药超过 M 或低于 N 时，为自身附加标记（条件满足时始终存在，不满足时立刻消失）。

* 触发关联标记。  
被挂上这种标记的单位可以被触发行为激活，激活后这些单位会成为那个触发的关联对象。

### 杂项

* 限制矿车只能采某一或几种矿物。

* 抛射体独立 arcing。

## 已添加（修改）完毕的功能

### 全局

* 重构通用块记录。  
这是一个内部逻辑的改变，并不体现在 ini 中。  
（#93）

* 单位完全支持类型转换。  
这是一个内部逻辑的改变，并不体现在 ini 中。  
（#90）

* 全局块 `[MarkControls]`。  
标记的弹头，对于需要使用弹头的标记，这里设置标记使用的默认弹头和一些其他的相关设置。  
详见 [属性-全局](/标记逻辑/属性-全局.md#属性-全局)。  
（#93 #98 #103）

* 改进单位类型和所属作战方的写法。  
详见 [类型-标记](/标记逻辑/类型-标记.md#完整结构)（各类标记效果不再列举） 和 [类型-判断单位条件](/其他新类型/类型-判断单位条件.md#类型-判断单位条件)。  
（#93）

* 作战方局部变量。  
详见 [数据-作战方局部变量](/触发与AI脚本动作/数据-作战方局部变量.md#数据-作战方局部变量)。  
（#93）

* 作战方局部变量相关的触发动作。  
详见 [触发动作-操作作战方局部变量](/触发与AI脚本动作/触发动作-3-操作作战方局部变量.md#触发动作-操作作战方局部变量)。  
（#100）

* 作战方局部变量相关的触发事件。  
详见 [触发事件-判断数值](/触发与AI脚本动作/触发事件-5-判断数值.md#触发事件-判断数值)。  
（#100 #101）

### AI 脚本动作

* 重写数据包结构。  
详见 [类型-数据包](/触发与AI脚本动作/类型-数据包.md#类型-数据包)、[类型-单位数据集合](/其他新类型/类型-单位数据集合.md#类型-单位数据集合)、[类型-超武数据集合](/其他新类型/类型-超武数据集合.md#类型-超武数据集合)、[类型-数值数据集合](/其他新类型/类型-数值数据集合.md#类型-数值数据集合)、[类型-脚本数据集合](/其他新类型/类型-脚本数据集合.md#类型-脚本数据集合)、[类型-偏移数据集合](/其他新类型/类型-偏移数据集合.md#类型-偏移数据集合)、[类型-计时数据集合](/其他新类型/类型-计时数据集合.md#类型-计时数据集合)、[类型-动画数据集合](/其他新类型/类型-动画数据集合.md#类型-动画数据集合)、[类型-输出文本设置](/其他新类型/类型-输出文本设置.md#类型-输出文本设置) 和 [类型-标记参数设置](/其他新类型/类型-标记参数设置.md#类型-标记参数设置)。  
（#94 #95 #96 #97 #98 #99）

* 由于底层逻辑和数据包结构的重构，原来的 AI 脚本动作编号停用（即这些 AI 脚本动作编号不再有效），在数据包结构重构完成后使用新的编号。  
这些脚本会在之后的数据包重做中变更为新的 AI 脚本动作。  
详见 [迁移说明](/迁移说明.md#开发版本相关相对于最新的发布版即相对于-008)。  
（#93 #94）

* 重写 AI 脚本动作编号（以及属性含义与关联）。  
详见 [AI脚本动作-杂项](/触发与AI脚本动作/AI脚本动作-1-杂项.md#ai脚本动作-杂项)、[AI脚本动作-操作标记](/触发与AI脚本动作/AI脚本动作-2-操作标记.md#ai脚本动作-操作标记)、[AI脚本动作-判断单位数量](/触发与AI脚本动作/AI脚本动作-4-判断单位数量.md#ai脚本动作-判断单位数量)。  
（#94 #95）

* 扩展判断单位数量的 AI 脚本动作。  
详见 [AI脚本动作-判断单位数量](/触发与AI脚本动作/AI脚本动作-4-判断单位数量.md#ai脚本动作-判断单位数量)。  
（#95）

* 作战方局部变量相关的 AI 脚本动作。  
详见 [AI脚本动作-操作作战方局部变量](/触发与AI脚本动作/AI脚本动作-3-操作作战方局部变量.md#ai脚本动作-操作作战方局部变量)。  
（#95）

* `脚本动作最大持续时间` AI 脚本动作（超时自动结束当前 AI 脚本动作并执行下一个 AI 脚本动作）。  
详见 [`脚本动作最大持续时间`](/触发与AI脚本动作/AI脚本动作-1-杂项.md#50001n-脚本动作最大持续时间)。  
（#97）

* `随机投放单位` AI 脚本动作支持播放动画和最大投放范围。  
详见 [`随机投放单位`](/触发与AI脚本动作/AI脚本动作-1-杂项.md#50030n-随机投放单位)。  
（#99 #103）

* `移动至随机坐标` AI 脚本动作。  
详见 [`移动至随机坐标`](/触发与AI脚本动作/AI脚本动作-1-杂项.md#50041n-移动至随机坐标)。  
（#99）

### 驻军逻辑

* 根据驻军人数变换驻军建筑的武器；根据驻军步兵的 `OccupyMode` 变换驻军建筑的武器。  
详见 [多驻军武器可切换的驻军武器](/功能扩展-驻军逻辑.md#多驻军武器可切换的驻军武器)。  
（#86 #87 #88 #89）

### 标记逻辑

* 标记免注册。（？？？）  
这是一个内部逻辑的改变，并不体现在 ini 中。  
（#100）

* 伤害来源判定，并可以作为标记生效的条件之一。  
详见 [类型-判断单位条件](/其他新类型/类型-判断单位条件.md#类型-判断单位条件)。  
（#85 #97）

* 合并各种影响挂载、激发标记等效果的参数属性和判断属性（属于标记效果的部分除外）。  
详见 [属性-弹头](/标记逻辑/属性-弹头.md#属性-弹头) 和 [类型-判断单位条件](/其他新类型/类型-判断单位条件.md#类型-判断单位条件)。  
（#85）

* 合并各种挂载、激发标记等效果标记初始化参数（属于标记效果的部分除外）。  
详见 [类型-标记](/标记逻辑/类型-标记.md#完整结构)、[属性-单位](/标记逻辑/属性-单位.md#属性-单位)、[属性-弹头](/标记逻辑/属性-弹头.md#属性-弹头) 和 [类型-标记参数设置](/其他新类型/类型-标记参数设置.md#类型-标记参数设置)。  
（#91 #92）

* 增加进入载具、离开载具时对载具、载员挂载标记的功能。  
详见 [载员标记](/标记逻辑/属性-单位.md#载员标记)。  
（#99）

* 增加进入建筑、离开建筑时对建筑、驻军挂载标记的功能。  
详见 [驻军标记](/标记逻辑/属性-单位.md#驻军标记)。  
（#99）

* 标记支持 AI 的难度区分 `AllowAIDifficulty`。  
详见 [类型-标记](/标记逻辑/类型-标记.md#完整结构)。  
（#93）

* 标记的强度值生效区间 `Power.Maxs.Effect` 和 `Power.Mins.Effect`。  
详见 [类型-标记](/标记逻辑/类型-标记.md#完整结构)。  
（#97）

* 标记的生命值。  
详见 [类型-标记](/标记逻辑/类型-标记.md#完整结构)、[属性-单位](/标记逻辑/属性-单位.md#标记抗性) 和 [类型-标记参数设置](/其他新类型/类型-标记参数设置.md#完整结构)。  
（#103）

* 标记的重复挂载和自动激发检测。  
详见 [类型-标记](/标记逻辑/类型-标记.md#完整结构)。  
（#103）

* 标记中 `切换至新的标记` 功能可以写多个标记（和相应的 `标记参数设置`）。  
详见 [类型-标记](/标记逻辑/类型-标记.md#完整结构)。
（#93）

* `引爆弹头` 标记增加了直接伤害的模式。  
详见 [`引爆弹头`](/标记逻辑/标记效果-1-杂项.md#引爆弹头-主动)。  
（#104）

* `标记激发` 和 `标记强度` 标记的参数进行了调整，使得不设置 `Effect.AcceptMarks` 属性时参数也有效果。  
详见 [`标记激发`](/标记逻辑/标记效果-2-标记处理.md#标记激发-主动) 和 [`标记强度`](/标记逻辑/标记效果-2-标记处理.md#标记强度-主动)。  
（#98）

* `静默状态` 标记生效期间，AI 的生产建筑会停止生产。  
详见 [`静默状态`](/标记逻辑/标记效果-1-杂项.md#静默状态-主动)。  
（#93）

* `嘲讽状态` 标记增加单位移动模式，单位类型限制以及相关的模式。  
详见 [`嘲讽状态`](/标记逻辑/标记效果-1-杂项.md#嘲讽状态-主动)。  
（#97 #98 #103）

* `生命恢复` 标记设置上下限制。  
详见 [`生命恢复`](/标记逻辑/标记效果-4-生命值.md#生命恢复-主动)。  
（#97）

* `伤害承担` 标记增加伤害穿透比例和承担概率。  
详见 [`伤害承担`](/标记逻辑/标记效果-3-受伤效果.md#伤害承担-主动自身受伤治疗)。  
（#97）

* `伤害反射` 标记增加反射给自己、触发概率的功能。  
详见 [`伤害反射`](/标记逻辑/标记效果-3-受伤效果.md#伤害反射-受伤治疗)。  
（#97 #105）

* `伤害免死` 标记增加【标记和弹头的触发时间间隔】。  
详见 [`伤害免死`](/标记逻辑/标记效果-3-受伤效果.md#伤害免死-受伤)。  
（#101）

* 添加标记的效果动画：  
[`投放单位`](/标记逻辑/标记效果-1-杂项.md#投放单位-主动) 标记，增加【投放时播放的动画】；  
[`死亡时投放单位`](/标记逻辑/标记效果-1-杂项.md#死亡时投放单位-亡语) 标记，增加【投放时播放的动画】；  
[`原地去世`](/标记逻辑/标记效果-1-杂项.md#原地去世-主动) 标记，增加【目标死亡成功时播放的动画】【目标死亡失败时播放的动画】；  
[`连锁死亡`](/标记逻辑/标记效果-1-杂项.md#连锁死亡-亡语) 标记，增加【目标死亡成功时播放的动画】【目标死亡失败时播放的动画】；  
[`建筑变卖`](/标记逻辑/标记效果-1-杂项.md#建筑变卖-主动) 标记，增加【变卖成功时播放的动画】【变卖失败时播放的动画】；  
[`静默状态`](/标记逻辑/标记效果-1-杂项.md#静默状态-主动) 标记，增加【处于静默状态的单位身上循环播放的动画】；  
[`嘲讽状态`](/标记逻辑/标记效果-1-杂项.md#嘲讽状态-主动) 标记，增加【触发时在自己身上播放的动画】【触发时在受影响单位身上播放的动画】；  
[`加成移动`](/标记逻辑/标记效果-1-杂项.md#加成移动-主动) 标记，增加【增加数值时播放的动画】；  
[`加成护甲`](/标记逻辑/标记效果-1-杂项.md#加成护甲-主动) 标记，增加【增加数值时播放的动画】；  
[`加成火力`](/标记逻辑/标记效果-1-杂项.md#加成火力-主动) 标记，增加【增加数值时播放的动画】；  
[`加成射速`](/标记逻辑/标记效果-1-杂项.md#加成射速-主动) 标记，增加【增加数值时播放的动画】；  
[`标记挂载`](/标记逻辑/标记效果-2-标记处理.md#标记挂载-主动) 标记，增加【生效时在自己身上播放的动画】【生效时在受影响单位身上播放的动画】；  
[`标记激发`](/标记逻辑/标记效果-2-标记处理.md#标记激发-主动) 标记，增加【生效时在自己身上播放的动画】【生效时在受影响单位身上播放的动画】；  
[`标记结束`](/标记逻辑/标记效果-2-标记处理.md#标记结束-主动) 标记，增加【生效时在自己身上播放的动画】【生效时在受影响单位身上播放的动画】；  
[`标记移除`](/标记逻辑/标记效果-2-标记处理.md#标记移除-主动) 标记，增加【生效时在自己身上播放的动画】【生效时在受影响单位身上播放的动画】；  
[`标记强度`](/标记逻辑/标记效果-2-标记处理.md#标记强度-主动) 标记，增加【生效时在自己身上播放的动画】【生效时在受影响单位身上播放的动画】；  
[`标记转换`](/标记逻辑/标记效果-2-标记处理.md#标记转换-主动) 标记，增加【生效时在自己身上播放的动画】【生效时在受影响单位身上播放的动画】；  
[`攻击标记挂载`](/标记逻辑/标记效果-2-标记处理.md#攻击标记挂载-攻击) 标记，增加【生效时播放的动画】；  
[`伤害承担`](/标记逻辑/标记效果-3-受伤效果.md#伤害承担-主动自身受伤治疗) 标记，增加【持有可承担伤害量时循环播放的动画】【受击但未破碎时播放的动画】【护盾破碎的动画】；  
[`伤害格挡`](/标记逻辑/标记效果-3-受伤效果.md#伤害格挡-主动受伤) 标记，增加【持有格挡层数时循环播放的动画】；  
[`伤害免疫`](/标记逻辑/标记效果-3-受伤效果.md#伤害免疫-自身受伤治疗) 标记，增加【持有时循环播放的动画】【受击时播放的动画】；  
[`伤害限制`](/标记逻辑/标记效果-3-受伤效果.md#伤害限制-受伤) 标记，增加【限制上限伤害时播放的动画】【限制下限伤害时播放的动画】；  
[`伤害隔离`](/标记逻辑/标记效果-3-受伤效果.md#伤害隔离-受伤) 标记，增加【隔离上限伤害时播放的动画】【隔离下限伤害时播放的动画】；  
[`伤害连锁`](/标记逻辑/标记效果-3-受伤效果.md#伤害连锁-受伤治疗) 标记，增加【在自己身上播放的动画】【在目标身上播放的动画】；  
[`伤害即死`](/标记逻辑/标记效果-3-受伤效果.md#伤害即死-受伤) 标记，增加【目标死亡成功时播放的动画】【目标死亡失败时播放的动画】；  
[`伤害免死`](/标记逻辑/标记效果-3-受伤效果.md#伤害免死-受伤) 标记，增加【受到致命伤害时播放的动画】；  
[`生命汲取`](/标记逻辑/标记效果-4-生命值.md#生命汲取-攻击) 标记，增加【在自己身上播放的动画】【在目标身上播放的动画】；  
[`生命锁定`](/标记逻辑/标记效果-4-生命值.md#生命锁定-主动自身受伤) 标记，增加【首次受到过量伤害后开始循环播放的动画】【受到过量伤害时播放的动画】；  
[`生命恢复`](/标记逻辑/标记效果-4-生命值.md#生命恢复-主动) 标记，增加【持有时循环播放的动画】【恢复生命值时播放的动画 (仅限有效恢复)】；  
[`生命重置`](/标记逻辑/标记效果-4-生命值.md#生命重置-主动) 标记，增加【重置生命值时播放的动画】。  
详见 [请看上面的各个标记](/待办事项.md)。  
（#100）

* `空效果` 标记与 `无效果` 标记。  
详见 [`空效果`](/标记逻辑/标记效果-0-无效果.md#空效果-主动) 和 [`无效果`](/标记逻辑/标记效果-0-无效果.md#无效果-主动)。  
（#93）

* `加成属性` 标记（目前包括了 `加成移动`、`加成护甲`、`加成火力` `加成射速` `加成经验值获取` `加成经验值提供` 标记）。  
详见 [`加成属性`](/标记逻辑/标记效果-1-杂项.md#加成属性-主动)。  
（#96 #103 #104）

* `生命重置` 标记。  
详见 [`生命重置`](/标记逻辑/标记效果-4-生命值.md#生命重置-主动)。  
（#97）

* `操作作战方局部变量-主动`、`操作作战方局部变量-死亡` 标记。  
详见 [`操作作战方局部变量-主动`](/标记逻辑/标记效果-502-操作作战方局部变量.md#操作作战方局部变量-主动-主动) 和 [`操作作战方局部变量-死亡`](/标记逻辑/标记效果-502-操作作战方局部变量.md#操作作战方局部变量-死亡-亡语)。  
（#101）

* `判断数值-主动`、`判断数值-死亡` 标记。  
详见 [`判断数值-主动`](/标记逻辑/标记效果-504-判断数值.md#判断数值-主动-主动) 和 [`判断数值-死亡`](/标记逻辑/标记效果-504-判断数值.md#判断数值-死亡-亡语)。  
（#101）

* `击杀标记挂载` 标记。  
详见 [`击杀标记挂载`](/标记逻辑/标记效果-2-标记处理.md#击杀标记挂载-击杀)。  
（#104）

* `经验值` 标记。  
详见 [`经验值`](/标记逻辑/标记效果-1-杂项.md#经验值-主动)。  
（#104）

### 杂项

* 重做了自定义军衔逻辑。  
详见 [自定义军衔](/功能扩展-经验值和军衔.md#自定义军衔)、[类型-单位升级设置](/其他新类型/类型-单位升级设置.md#类型-单位升级设置) 和 [类型-军衔图像设置](/其他新类型/类型-军衔图像设置.md#类型-军衔图像设置)。  
（#94 #104 #105）

* 重做了经验值逻辑。  
详见 [提供经验值](/功能扩展-经验值和军衔.md#提供经验值) 和 [获取经验值](/功能扩展-经验值和军衔.md#获取经验值)。  
（#104  #105）

* 重做了升级行为逻辑。
详见 [升级行为](/功能扩展-经验值和军衔.md#升级行为) 和 [类型-单位升级设置](/其他新类型/类型-单位升级设置.md#类型-单位升级设置)。  
（#105）

* `真·多段电弧` 武器特效。  
详见 [`真·多段电弧`](/功能扩展-武器.md#武器---真多段电弧)。  
（#101 #102）

* `真实伤害` 弹头。  
详见 [`真实伤害`](/功能扩展-弹头.md#弹头---真实伤害)。  
（#101）

* `最终归零` 弹头。  
详见 [`最终归零`](/功能扩展-弹头.md#弹头---最终归零)。  
（#101）

* `经验值` 弹头。  
详见 [`经验值`](/功能扩展-弹头.md#弹头---经验值)。  
（#104 #105）

## 想来想去添不上去的功能

### 标记逻辑

* 标记的几个强度值判断，用 `-2147483648` 表示不判断。  
数据精度不够，暂时搞不定（而且这个数值也太怪了）。

## 如果你还想要某个功能的话

#### 如果你确实需要这个逻辑，那么可以提出它（请找我私聊而不是在 git 中提出），但是具体能不能加得上就是另一个故事了。

### 以下请求会被拒绝

* 修复其他扩展平台引入的 bug，包括其他扩展平台修了但没完全修好的原版就有的 bug。

* 添加改善 ini 编写的功能（类似于经典的块继承这种的），这类功能请提给 INI 连接器。

* 扩充文件载入范围类的功能（栗如想要支持直接读取名为 `rulesEX.ini` 的文件或者想要支持读取 `.png` 文件什么的）。

* 一看就没什么意义，甚至有些离谱的功能（栗如在游戏里打开一个界面编写 ini 代码）。