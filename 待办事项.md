# 待办事项 v0.0.9

## 目前准备添加的功能

### 这里列出已经确定确实可以加上的功能，它们会被陆续添加到平台扩展中。

### AI 脚本动作

* 重写 AI 脚本动作编号（以及属性含义与关联）。

* 下个 AI 脚本动作的最长执行时间的 AI 脚本动作（超时自动结束当前 AI 脚本动作并执行下一个 AI 脚本动作）。

* 扩展判断单位数量的 AI 脚本动作。

* 作战方局部变量相关的触发和 AI 脚本动作。

### 标记逻辑

* 增加进入载具、离开载具、进入建筑、离开建筑时对建筑和单位挂标记的功能（具体项目待定，暂不支持 ARES 巷战导致的步兵在建筑内扑街）。

* 生命恢复标记设置上下限制。

* 嘲讽标记增加单位类型限制。

* 标记的强度值生效区间。

* 引发事件标记（关联地图触发）。

* 伤害反射标记增加反射给自己的功能。

* 生命重设标记。

* 替代武器标记。

* 添加标记的效果动画。  
单位投放，1 个动画，每次投放时播放的动画。  
死亡投放，1 个动画，每次投放时播放的动画。  
原地去世，2 个动画，令目标死亡时播放的动画，没有使其死亡时播放的动画。  
连锁死亡，2 个动画，令目标死亡时播放的动画，没有使其死亡时播放的动画。  
变卖，1 个动画，生效时刻播放的动画。  
静默，1 个动画，处于静默状态的单位身上循环播放的动画。  
嘲讽，2 个动画，每次触发时在自己身上播放的动画，在受影响单位身上播放的动画。  
挂载标记，2 个动画，每次生效时在自己身上播放的动画，在受影响单位身上播放的动画。  
激发标记，2 个动画，每次生效时在自己身上播放的动画，在受影响单位身上播放的动画。  
结束标记，2 个动画，每次生效时在自己身上播放的动画，在受影响单位身上播放的动画。  
移除标记，2 个动画，每次生效时在自己身上播放的动画，在受影响单位身上播放的动画。  
修改强度，2 个动画，每次生效时在自己身上播放的动画，在受影响单位身上播放的动画。  
转换标记，2 个动画，每次生效时在自己身上播放的动画，在受影响单位身上播放的动画。  
攻击标记，1 个动画，添加标记时播放的动画。  
护盾，3 个动画，持有护盾时循环播放的动画，受击但未击破时播放的动画，护盾破碎动画。  
格挡，2 个动画，格挡层数≥1时循环播放的动画，成功格挡时播放的动画。  
免疫，2 个动画，受击时播放的动画，持有时循环播放的动画。  
闪避，1 个动画，成功闪避时播放的动画。  
隔离，2 个动画，隔离高伤时播放的动画，隔离低伤时播放的动画。  
限伤，2 个动画，限制高伤时播放的动画，限制低伤时播放的动画。  
连锁，2 个动画，目标身上播放的动画，自己身上播放的动画。  
即死，2 个动画，令目标成功死亡时播放的动画，没有使其死亡时播放的动画。  
免死，1 个动画，受到致死伤害时播放的动画。  
吸血，2 个动画，目标身上播放的动画，自己身上播放的动画。  
锁血，2 个动画，首次受到过量伤害后开始循环播放的动画，每次受到过量伤害时播放的动画。  
自愈，2 个动画，持有时循环播放的动画，每次自愈播放的动画。

### 杂项

* 真·多段电弧（一种武器特效）。

* 伤害强制归 0 弹头（优化项）。

## 可能会增加的功能

### 由于不确定是否可以加得上的功能，以及暂时没有合适的解决方案的功能会列在此处。一旦这些功能获得了合适的解决方案，就会被添加到平台扩展中。

### 标记逻辑

* 伤害来源判定，并可以作为标记生效的条件之一。

* 标记的几个强度值判断，用 `-2147483648` 表示不判断。

* 所有带弹头的标记增加直接扣血的可选效果。

* 标记所属方，加个是否固定不变的功能。  
即不论单位的所属方如何变化，始终为附加瞬间的所属方。

* 揭示黑幕标记。

* 扩散连锁标记。

* 扩散弹头（抛射体）标记。

* 记录单位类型标记。

* 医院和医院成员标记（自定义医院）。

* 除你武器标记。

* 逆分摊标记。

* 广播标记。  
广播动画，自身位置播放的动画，收到广播的单位处播放的动画。  
广播半径、广播间隔、广播次数、广播持续时间。  
根据自身持有的标记、血量、强度值等效果，决定是否生效。

* 弹药标记。  
使携带该标记的单位，在每次触发时使弹药增加或减少一定数值。  
当弹药超过 A 或低于 B 时均会禁用指定的武器（会尝试切换为另一个可使用的武器攻击）。  
当弹药超过 M 或低于 N 时，为自身附加标记（条件满足时始终存在，不满足时立刻消失）。

### 杂项

* 限制矿车只能采某一或几种矿物。

* 抛射体独立 arcing。

## 已添加（修改）完毕的功能

### 全局

* 重构通用块记录。  
这是一个内部逻辑的改变，并不体现在 ini 中。  
（#93）

* 作战方局部变量。  
详见 [数据-作战方局部变量](/触发与AI脚本动作/数据-作战方局部变量.md)。  
（#93）

* 单位完全支持类型转换。  
这是一个内部逻辑的改变，并不体现在 ini 中。  
（#90）

* 全局块 `[MarkControls]`。  
标记的弹头，对于需要使用弹头的标记，这里设置它们的默认弹头。  
详见 [属性-全局](/标记逻辑/属性-全局.md)。  
（#93）

* 改进单位类型和所属作战方的写法。  
详见 [类型-标记](/标记逻辑/类型-标记.md)（各类标记效果不再列举） 和 [类型-判断单位条件](/其他新类型/类型-判断单位条件.md)。  
（#93）

### AI 脚本动作

* 重写数据包结构。  
详见 [类型-数据包](/触发与AI脚本动作/类型-数据包.md)、[类型-单位数据集合](/其他新类型/类型-单位数据集合.md)、[类型-数值数据集合](/其他新类型/类型-数值数据集合.md)、[类型-脚本数据集合](/其他新类型/类型-脚本数据集合.md)、[类型-偏移数据集合](/其他新类型/类型-偏移数据集合.md)、[类型-计时数据集合](/其他新类型/类型-计时数据集合.md)。  
（#94）

* 由于底层逻辑和数据包结构的重构，AI 脚本动作 `29900` `29901` `29902` `29903` `29920` `29921` `29924` `29925` 暂时停用，会在数据包结构重构完成后恢复（这些 AI 脚本动作仍然是合法的，只是不再发挥效果）。  
这些脚本分别是：随机脚本，输出信息，输出 `debug.log` 文本，随机超武，挂载标记，激发标记，合并标记强度值，转换标记。  
这些脚本会在之后的数据包重做中变更为新的 AI 脚本动作。  
（#93）

### 驻军逻辑

* 根据驻军人数变换驻军建筑的武器；根据驻军步兵的 `OccupyMode` 变换驻军建筑的武器。  
详见 [驻军逻辑](/功能扩展-驻军逻辑.md)。  
（#86 ~ #89）

### 标记逻辑

* 合并各种影响挂载、激发标记等效果的参数属性和判断属性（属于标记效果的部分除外）。  
详见 [功能扩展-弹头](/功能扩展-弹头.md) 和 [类型-判断单位条件](/其他新类型/类型-判断单位条件.md)。  
（#85）

* 合并各种挂载、激发标记等效果标记初始化参数（属于标记效果的部分除外）。  
详见 [类型-标记](/标记逻辑/类型-标记.md)、[属性-单位](/标记逻辑/属性-单位.md)、[属性-弹头](/标记逻辑/属性-弹头.md) 和 [类型-标记参数设置](/其他新类型/类型-标记参数设置.md)。  
（#91 ~ #92）

* `静默状态` 标记生效期间，AI 的生产建筑会停止生产。  
详见 [标记效果-杂项](/标记逻辑/标记效果-1-杂项.md)。  
（#93）

* 标记中 `切换至新的标记` 功能可以写多个标记（和相应的 `标记参数设置`）。  
详见 [类型-标记](/标记逻辑/类型-标记.md)。
（#93）

* 标记支持 AI 的难度区分 `AllowAIDifficulty`。  
详见 [类型-标记](/标记逻辑/类型-标记.md)。  
（#93）

* `空效果` 标记与 `无效果` 标记。  
详见 [标记效果-无效果](/标记逻辑/标记效果-0-无效果.md)。  
（#93）

### 杂项

* 重做了自定义军衔逻辑。  
详见 [功能扩展-自定义军衔](/功能扩展-自定义军衔.md) 和 [类型-军衔图像设置](/其他新类型/类型-军衔图像设置.md)。  
（#94）

## 如果你还想要某个功能的话

#### 如果你确实需要这个逻辑，那么可以提出它（请找我私聊而不是在 git 中提出），但是具体能不能加得上就是另一个故事了。

### 以下请求会被拒绝

* 修复其他扩展平台引入的 bug，包括其他扩展平台修了但没完全修好的原版就有的 bug。

* 添加改善 ini 编写的功能（类似于经典的块继承这种的），这类功能请提给 INI 连接器。

* 扩充文件载入范围类的功能（栗如想要支持直接读取名为 `rulesEX.ini` 的文件或者想要支持读取 `.png` 文件什么的）。

* 一看就没什么意义，甚至有些离谱的功能（栗如在游戏里打开一个界面编写 ini 文件）。