# 标记效果-杂项

## 引爆弹头 <主动>

位于 `rulesmd.ini`：

```ini
[SomeMarkType]
Effect.Type=Warhead
```

在单位脚下引爆一排弹头，单位自己射自己，最终伤害是个整数（去尾）。  
进入生效状态立刻引爆一次，最终引爆完毕后立刻进入结束状态。

### 注意

* 由于默认是单位自己射自己，所以弹头需要设置 `AllowDamageOnSelf=yes` 才有伤害。

### 强度值转换：N 项参数

参数项数与 `Effect.Warheads` 的长度相匹配。  
每一项都是【对应每个弹头的伤害】：`0` = 没伤害，负数 = 治疗，默认值是 `0`。

### 其他属性

位于 `rulesmd.ini`：

```ini
[SomeMarkType]
; 效果种类相关属性
Effect.Warheads=                                ; 弹头列表 , 没有弹头直接进入结束状态
Effect.Healths=-1                               ; 浮点数 , 单位的【生命值下限】 , 当单位当前生命值 <= 【生命值下限】时, 弹头才会引爆 (仍会按照 Delay 来引爆) , 0.2 = 20% 的生命值 , 负数 = 条件不生效 , 默认值是 -1
Effect.Counts=-1                                ; 整数 , 引爆次数 , 次数耗尽会立刻进入结束状态 , 等于 0 会无法生效并直接进入结束状态 (算作次数耗尽) , 负数 = 无限次 , 默认值是 -1 , 单位 : 次
Effect.Amounts=-1                               ; 整数 , 每次引爆的弹头数量 , 负数 = 全炸一遍 , 0 = 炸不出来 , 默认值是 -1 , 单位 : 个
Effect.Delay=0                                  ; 整数 , 每隔这么多帧炸一次 , 小于 0 按 0 算 , 但是每一帧最多炸一次 , 默认值是 0 , 单位 : 帧
Effect.Random=no                                ; yes/no , 不全部引爆时 , 是否随机选择弹头 , 不随机则从第一个一直爆到最后一个 , 然后再回到第一个 (只引爆一次时就永远是第一个弹头) , 默认值是 no
Effect.Self=yes                                 ; yes/no , yes = 引爆的弹头是标记所属单位的阵营 , no = 引爆的弹头是挂载标记的单位的阵营 (需要单位存活) , 默认值是 yes
                                                ; 如果阵营不是正常的状态 (比如已经被击败) , 则标记会立刻进入结束状态
Effect.Modes=0                                  ; 整数 , 【不符合生命值时是否消耗次数的模式】 , 无效值默认为 0 , 默认值是 0
                                                ; 【不符合生命值时是否消耗次数的模式】
                                                ; 0 = 不消耗次数
                                                ; 1 = 消耗次数
```



## 死亡时引爆弹头 <亡语>

位于 `rulesmd.ini`：

```ini
[SomeMarkType]
Effect.Type=WarheadDeath
```

在单位脚下引爆一排弹头，单位自己射自己，最终伤害是个整数（去尾）。

### 注意

* 由于默认是单位自己射自己，所以弹头需要设置 `AllowDamageOnSelf=yes` 才有伤害。

### 强度值转换：N 项参数

参数项数与 `Effect.Warheads` 的长度相匹配。  
每一项都是【对应每个弹头的伤害】：`0` = 没伤害，负数 = 治疗，默认值是 `0`。

### 其他属性

位于 `rulesmd.ini`：

```ini
[SomeMarkType]
; 效果种类相关属性
Effect.Warheads=                                ; 弹头列表 , 没有弹头直接进入结束状态
Effect.Amounts=-1                               ; 整数 , 每次引爆的弹头数量 , 负数 = 全炸一遍 , 0 = 炸不出来 , 默认值是 -1 , 单位 : 个
Effect.Timer=0                                  ; 整数 , 生效时间的最大值 , 超过时间限制会立刻进入结束状态 , 0 = 无限 , 小于 0 按 0 算 , 默认值是 0 , 单位 : 帧
Effect.Random=no                                ; yes/no , 不全部引爆时 , 是否随机选择弹头 , 不随机则从第一个一直爆到最后一个 , 然后再回到第一个 (永远从第一个弹头开始 , 引爆数量够多可以全炸好几遍) , 默认值是 no
```



## 发射武器 <主动>

位于 `rulesmd.ini`：

```ini
[SomeMarkType]
Effect.Type=Weapon
```

从单位身上发射武器，发射者是单位自己，瞄准范围内的随机目标（除了自己）。
使用武器的 `Damage`、`ROF`、`Range`、`Speed`、`Burst`、`Warhead`、`Projectile`、`Report`、支持绘制激光、电流、辐射、粒子系统。

### 注意

* 暂不支持特殊武器效果和图形（含扩展的），暂不支持开火动画和使用单位的开火位置。

* 武器的属性缺失或填了不合适的值可能会导致弹窗。

### 强度值转换：5 项参数

|参数|说明|
|-|-|
|【武器伤害倍率】     |-1 = 没伤害，-1 ~ 0 = 伤害降低，0 = 无变化，1 = 伤害翻倍，默认值是 `0`，单位：点。|
|【武器射程倍率】     |-1 = 没射程，-1 ~ 0 = 射程减小，0 = 无变化，1 = 射程翻倍（小心游戏变卡），小于 -1 按 -1 算，默认值是 `0`，单位：格。|
|【武器开火间隔倍率】 |不影响连发开火间隔，-1 = 无间隔（每帧最多开火 1 次），-1 ~ 0 = 间隔减小，0 = 无变化，1 = 间隔翻倍，小于 -1 按 -1 算，默认值是 `0`，单位：帧。|
|【连发开火间隔】     |连发开火开火间隔默认 5 帧，-5 = 0 帧（每帧最多开火 1 次），-2 = 3 帧，0 = 5 帧，10 = 15 帧，默认值是 `0`，单位：帧。|
|【开火概率】         |开火的概率，每个连发单独计算概率，-1 = 开不出来，-0.4 = 60% 的概率开火，0 = 100%，小于 -1 按 -1 算，默认值是 `0`。|

### 其他属性

位于 `rulesmd.ini`：

```ini
[SomeMarkType]
; 效果种类相关属性
Effect.Weapons=                                 ; 武器列表 , 用于开火的武器 , 可以有多个 , 没有武器直接进入结束状态 , 任意武器不存在或任意武器没有弹头会立刻进入结束状态 , 暂不支持同时开火
Effect.Counts=-1                                ; 整数 , 开火次数 , 次数耗尽会立刻进入结束状态 , 等于 0 会无法生效并直接进入结束状态 (算作次数耗尽) , 负数 = 无限次 , 默认值是 -1 , 单位 : 次
Effect.Timer=0                                  ; 整数 , 生效时间的最大值 , 超过时间限制会立刻进入结束状态 , 0 = 无限 , 小于 0 按 0 算 , 默认值是 0 , 单位 : 帧
Effect.Random=no                                ; yes/no , 武器开火后 (成功开火且完成 Burst 后才会切换) , yes = 选择随机武器 , no = 选择列表顺序的下一个武器 (列表最后一个武器会循环至第一个武器) , 默认值是 no
Effect.Owners=All                               ; 作战方归属 , 符合阵营的单位才能被选为攻击目标 , 可用值 : All | Self | Allies | Enemies | SelfAllies | AlliesEnemies | SelfEnemies | Neutral (不区分大小写) , 默认值是 All
                                                ; 可用值含义 : 全部 | 己方 | 盟友 | 敌方 | 己方和盟友 | 盟友和敌方 | 己方和敌方 | 中立
Effect.Offset=0,0,0                             ; 三个整数 , 开火坐标 XYZ (顺序和数值比例同 FLH , 可以照抄) , 随着单位本体的朝向旋转 , 暂不支持使用单位自己的开火坐标 , 默认值是 0,0,0
Effect.Modes=0,0,0,0,0                          ; 五个整数 , 【目标选择模式】【切换武器模式】【对 0% 护甲反应模式】【对 1% 护甲反应模式】【检查武器的瞄准标记的模式】 , 无效值默认为 0 , 默认值是 0
                                                ; 【目标选择模式】
                                                ; 0 = 同步挂载的单位的攻击目标 , 且单位不再攻击时 (比如按下 S 键后) 放弃目标
                                                ; 1 = 同步挂载的单位的攻击目标 , 且单位不再攻击时 (比如按下 S 键后) 仍然锁定之前的目标并尝试攻击
                                                ; 2 = 自己选择目标并持续攻击
                                                ; 3 = 打一枪换一个目标
                                                ; 【切换武器模式】
                                                ; 0 = 无可攻击目标时自动切换武器 (周围有潜在目标时)
                                                ; 1 = 不切换武器 , 如果一个武器使用无法开火 , 就会卡在这里再也无法开火
                                                ; 【对 0% 护甲反应模式】
                                                ; 0 = 无视护甲进行攻击 , 虽然可能没伤害
                                                ; 1 = 不攻击 0% 的护甲 , 正常计算 ROF (性能略微低一点)
                                                ; 【对 1% 护甲反应模式】
                                                ; 0 = 无视护甲进行攻击
                                                ; 1 = 不攻击 1% 的护甲 , 正常计算 ROF (性能略微低一点)
                                                ; 【检查武器的瞄准标记的模式】
                                                ; 0 = 不检查
                                                ; 1 = 检查 (性能略微低一点)
```



## 投放单位 <主动>

位于 `rulesmd.ini`：

```ini
[SomeMarkType]
Effect.Type=Team
```

效果等同于 AI 脚本动作 `29904,n`。  
以单位所在位置为 [原点] 创建随机单位，建筑步兵载具飞机都行，如果目标位置被占据了，则会在旁边创建。  
投放的单位归属为标记的持有者，也就是被挂载标记的单位的所属方。  
进入生效状态立刻投放一次，最终投放完毕后立刻进入结束状态。

### 注意

* 投放得太快太多可能造成游戏卡顿甚至崩溃。

### 强度值转换：1 项参数

|参数|说明|
|-|-|
|【投放的概率】|未成功投放也会消耗次数，0.2 = 20% 的概率，0 = 无法投放，小于 0 按 0 算，默认值是 `0`。|

### 其他属性

位于 `rulesmd.ini`：

```ini
[SomeMarkType]
; 效果种类相关属性
Effect.DataPack=                                ; 数据包的注册名 , 注意不是填写 IDCode , 数据包含义请见【AI 脚本动作 29904,n】 , 没有数据包直接进入结束状态
Effect.Counts=-1                                ; 整数 , 投放次数 , 次数耗尽会立刻进入结束状态 , 等于 0 会无法生效并直接进入结束状态 (算作次数耗尽) , 负数 = 无限次 , 默认值是 -1 , 单位 : 次
Effect.Delay=0                                  ; 整数 , 每隔这么多帧投一次 , 小于 0 按 0 算 , 但是每一帧最多投一次 , 默认值是 0 , 单位 : 帧
Effect.Self=yes                                 ; yes/no , yes = 投出的单位是标记所属单位的阵营 , no = 投出的单位是挂载标记的单位的阵营 (需要单位存活) , 默认值是 yes
                                                ; 如果阵营不是正常的状态 (比如已经被击败) , 则标记会立刻进入结束状态
```