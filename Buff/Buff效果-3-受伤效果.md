# Buff效果-受伤效果

## 伤害承担 <主动，自身，受伤，治疗>

位于 `rulesmd.ini`：

```ini
[SomeBuffType]
Effect.Type=DamageShield
```

类似于 Phobos 的护盾但是没有额外的护甲，只能吸收伤害，负数恢复量倒扣可承担伤害量，暂不支持设置独立动画。

### 注意

* 0 伤害和负伤害不参与承担。

### 效果强度值转换：6 项参数

|参数|说明|
|:-:|:-|
|【初始可承担伤害量】|小于 0 按 0 算，默认值是 `0`，单位：点。|
|【每次恢复量】|负数 = 倒扣可承担伤害量，0 = 不会自动恢复，默认值是 `0`，单位：点。|
|【最大可承担伤害量】|0 = 不限制，小于 0 按 0 算，默认值是 `0`，单位：点。|
|【穿透伤害比例】|0 = 0%，0.2 = 20%，负数 = 恢复单位的生命值，默认值是 `0`。|
|【未穿透伤害比例】|打在盾上的伤害倍率，-1 = 0%，-0.2 = 80%，0 = 100%，小于 -1 = 恢复可承担伤害量，默认值是 `0`。|
|【承担概率】|未承担的话，单位会受到原始伤害，-1 = 0%，-0.2 = 80%，0 = 100%，小于 -1 按 -1 算，默认值是 `0`。|

### 效果种类相关属性

位于 `rulesmd.ini`：

```ini
[SomeBuffType]
; 效果种类相关属性
Effect.Anims=                                   ; 五个动画 , 【成功承担伤害时播放的动画】【不成功时播放的动画 (可承担伤害量耗尽时)】【持有可承担伤害量时循环播放的动画】
                                                ; 【受击但未破碎时播放的动画】【护盾破碎的动画】 , 不写就不显示动画
Effect.AnimDelays=31                            ; 整数 , 每次播放【持有可承担伤害量时循环播放的动画】的延迟时间 , 默认值是 31
Effect.Counts=-1                                ; 整数 , 最多可以恢复可承担伤害量的次数 , 恢复次数耗尽且可承担伤害量耗尽会立刻进入结束状态 , 负数 = 无限次 , 默认值是 -1 , 单位 : 次
Effect.Timer=0                                  ; 整数 , 生效时间的最大值 , 超过时间限制会立刻进入结束状态 , 0 = 无限 , 小于 0 按 0 算 , 默认值是 0 , 单位 : 帧
Effect.Delay=0                                  ; 整数 , 恢复可承担伤害量的时间间隔 , 小于 0 按 0 算 , 但是每一帧最多恢复一次 , 默认值是 0 , 单位 : 帧
Effect.Modes=0,0                                ; 两个整数 , 【吸收伤害模式】和【吸收溢出伤害模式】 , 无效值默认为 0 , 默认值是 0
                                                ; 【吸收伤害模式】
                                                ; 0 = 吸收伤害
                                                ; 1 = 吸收治疗
                                                ; 2 = 全都吸收 , 伤害和治疗均扣除可承担伤害量
                                                ; 【吸收溢出伤害模式】
                                                ; 0 = 不吸收溢出伤害
                                                ; 1 = 吸收溢出伤害
```

### 广播与监听相关属性

不支持广播或监听。

### 数值显示相关属性

|应用的数值显示|【当前值】|【最大值】|【最小值】|【增加值】|说明|
|:-|:-:|:-:|:-:|:-:|:-|
|`Digital.Primary=`|当前可承担伤害量|【最大可承担伤害量】|-|【每次恢复量】||
|`Digital.Secondary=`|恢复的剩余时间|恢复的时间间隔|-|-|没有可恢复次数后此项将一直是空的，此项不支持【血条】的缓冲残影。|
|`Digital.Tertiary=`|剩余的生效时间|生效时间的最大值|-|-|此项不支持【血条】的缓冲残影。|
|`Digital.Quaternary=`|-|-|-|-|未使用此项数值显示。|
|`Digital.Button=`|-|-|-|-|未使用按钮功能。|



## 伤害格挡 <主动，受伤>

位于 `rulesmd.ini`：

```ini
[SomeBuffType]
Effect.Type=DamageBlock
```

类似于 Phobos 的护盾但是没有额外的护甲，只能按被攻击的次数吸收伤害，每成功吸收一次攻击掉一层，负数恢复量倒扣层数，暂不支持设置独立动画。

### 注意

* 计算格挡层数（包括恢复量）的时候是浮点数（格挡层数可以是 3.14 层），当单位不足一层的时候也会处理格挡，即 0.14 层有 14% 的概率格挡。

### 效果强度值转换：6 项参数

|参数|说明|
|:-:|:-|
|【无可用层数时格挡概率】|未成功格挡也会导致层数归 0，0 = 0%，0.2 = 20%，小于 0 按 0 算，默认值是 `0`。|
|【格挡成功时的受伤倍率】|0.1 = 受到原始伤害 10% 的伤害，0 = 免除伤害，默认值是 `0`。|
|【初始格挡层数】|小于 0 按 0 算，默认值是 `0`，单位：层。|
|【每次恢复层数】|可以不是整数层，负数 = 倒扣格挡层数，0 = 不会自动恢复，默认值是 `0`，单位：层。|
|【最大格挡层数】|0 = 不限制，小于 0 按 0 算，默认值是 `0`，单位：层。|
|【格挡概率】|未成功格挡也会减少层数，-1 = 0%，-0.2 = 80%，0 = 100%，小于 -1 按 -1 算，默认值是 `0`。|

### 效果种类相关属性

位于 `rulesmd.ini`：

```ini
[SomeBuffType]
; 效果种类相关属性
Effect.Anims=                                   ; 三个动画 , 【成功格挡时播放的动画】【不成功时播放的动画 (格挡层数耗尽时)】【持有格挡层数时循环播放的动画】 , 不写就不显示动画
Effect.AnimDelays=31                            ; 整数 , 每次播放【持有格挡层数时循环播放的动画】的延迟时间 , 默认值是 31
Effect.Counts=-1                                ; 整数 , 最多可以恢复格挡层数的次数 , 恢复次数耗尽且格挡层数耗尽会立刻进入结束状态 , 负数 = 无限次 , 默认值是 -1 , 单位 : 次
Effect.Timer=0                                  ; 整数 , 生效时间的最大值 , 超过时间限制会立刻进入结束状态 , 0 = 无限 , 小于 0 按 0 算 , 默认值是 0 , 单位 : 帧
Effect.Delay=0                                  ; 整数 , 恢复格挡层数的时间间隔 , 小于 0 按 0 算 , 但是每一帧最多恢复一次 , 默认值是 0 , 单位 : 帧
```

### 广播与监听相关属性

不支持广播或监听。

### 数值显示相关属性

|应用的数值显示|【当前值】|【最大值】|【最小值】|【增加值】|说明|
|:-|:-:|:-:|:-:|:-:|:-|
|`Digital.Primary=`|当前格挡层数|【最大格挡层数】|-|【每次恢复层数】||
|`Digital.Secondary=`|恢复的剩余时间|恢复的时间间隔|-|-|没有可恢复次数后此项将一直是空的，此项不支持【血条】的缓冲残影。|
|`Digital.Tertiary=`|剩余的生效时间|生效时间的最大值|-|-|此项不支持【血条】的缓冲残影。|
|`Digital.Quaternary=`|-|-|-|-|未使用此项数值显示。|
|`Digital.Button=`|-|-|-|-|未使用按钮功能。|



## 伤害分摊 <受伤，治疗>

位于 `rulesmd.ini`：

```ini
[SomeBuffType]
Effect.Type=DamageShare
```

持有此 Buff 的单位受到攻击时，会把一部分伤害分散给周围的单位承担（通过使用弹头），每个单位均分这些伤害。  
`DamageProcessType` 属性有效。

### 注意

* 分摊比例超过 100% 时，会把原始伤害分摊成负数伤害。

* 如果没有找到可分摊的目标伤害，则被攻击者会承担这些伤害（包括增幅后的部分）。

* 如果分摊目标太多或分摊伤害过小，则无法对分摊目标造成有效伤害。

* 已经分摊的伤害无法被再次分摊，0 伤害不参与分摊。

### 效果强度值转换：3 项参数

|参数|说明|
|:-:|:-|
|【分摊比例】|0 = 无法分摊，小于 0 按 0 算，默认值是 `0`。|
|【分摊数值上限】|对于负数伤害（治疗），如果其绝对值超过【分摊数值上限】则会受到限制，此时【分摊数值上限】看作伤害的最小值，0 = 不限制，小于 0 按 0 算，默认值是 `0`，单位：点。|
|【分摊部分增幅倍率】|`最终分摊伤害 = 原始伤害数值 * 分摊比例 * ( 1 + 分摊部分增幅倍率 )`，-1 = 无分摊伤害，0 = 原始分摊伤害，-1 ~ 0 = 分摊伤害降低，默认值是 `0`。|

### 效果种类相关属性

位于 `rulesmd.ini`：

```ini
[SomeBuffType]
; 效果种类相关属性
Effect.Anims=                                   ; 两个动画 , 【实际被分摊到伤害的单位处播放的动画 (自己)】【实际被分摊到伤害的单位处播放的动画 (别人)】【成功分摊时播放的动画】【被攻击时播放的动画】 , 此为额外动画 , 不影响弹头动画 , 不写就不显示动画
                                                ; 不写【实际被分摊到伤害的单位处播放的动画 (别人)】时默认使用【实际被分摊到伤害的单位处播放的动画 (自己)】
Effect.Technos=                                 ; 单位列表 , 只能向这些单位分摊伤害 , 不写或留空表示允许分摊给任何单位
Effect.Warheads=                                ; 弹头 , 向其他单位分摊伤害时使用的弹头 , 最终伤害会因为弹头改变而受到影响 , 不写或留空就使用此次攻击所使用的弹头
Effect.Counts=-1                                ; 整数 , 最多可以分摊伤害的次数 , 次数耗尽会立刻进入结束状态 , 等于 0 会无法生效并直接进入结束状态 (算作次数耗尽) , 负数 = 无限次 , 默认值是 -1 , 单位 : 次
Effect.Amounts=-1                               ; 整数 , 分摊时最多分摊给多少个单位 , 可用单位数量超过这个数量时随机抽取幸运观众 (不含等于) , 负数 = 不限制 , 默认值是 -1 , 单位 : 个
Effect.Delay=0                                  ; 整数 , 每次分摊后需要等待的时间 , 0 = 不限制 , 小于 0 按 0 算 , 默认值是 0 , 单位 : 帧
Effect.Range=0                                  ; 浮点数 , 分摊的范围 (半径) , 0 = 不分摊 , 小于 0 按 0 算 , 默认值是 0 , 单位 : 格子
Effect.Random=no                                ; yes/no , 当分摊给有限个单位时 , 可用单位数量超过 Effect.Amounts 的数量时 , 是否允许重复随机抽取 (也就是一个单位可能会被分摊两次或更多次) , 默认值是 no
Effect.Self=yes                                 ; yes/no , 是否分摊给自己 (自己也是可能的分摊对象之一) , 默认值是 yes
Effect.Source=no                                ; yes/no , 分摊的伤害的来源是否为原始攻击单位 , 默认值是 no
Effect.Owner=All                                ; 作战方归属 , 需要目标单位符合作战方
                                                ; 可用值 : All (无简写) , Self | S , Allies | A , Enemies | E , Neutral | N , 默认值是 All (不区分大小写)
                                                ; 当需要匹配多种作战方时 , 多个值之间使用 "," 符号连接即可 , 栗如同时匹配己方和敌方 : Self,Enemies 或 S,E (简写可以混用 , 不要有空格)
Effect.Modes=0                                  ; 整数 , 【分摊模式】 , 无效值默认为 0 , 默认值是 0
                                                ; 【分摊模式】
                                                ; 0 = 均分 , 有一个算一个 , 都受到同样的伤害 (原始伤害)
                                                ; 1 = 当前生命值占比 , 按照【目标单位的当前生命值】在【所有均分目标单位的当前生命值总和】中的占比分得伤害 (原始伤害)
                                                ; 2 = 生命值上限占比 , 同上 , 只不过是生命值上限
                                                ; 3 = 原伤害 , 都受到相同的伤害 (原始伤害 , 伤害不按数量分摊)
```

### 广播与监听相关属性

不支持广播或监听。

### 数值显示相关属性

不支持数值显示。



## 伤害免疫 <自身，受伤，治疗>

位于 `rulesmd.ini`：

```ini
[SomeBuffType]
Effect.Type=DamageImmune
```

根据条件对受到的伤害进行免疫。

### 注意

* 0 伤害不参与免疫。

### 效果强度值转换：0 项参数

### 效果种类相关属性

位于 `rulesmd.ini`：

```ini
[SomeBuffType]
; 效果种类相关属性
Effect.Anims=                                   ; 四个动画 , 【成功免疫时播放的动画】【不成功时播放的动画】【持有时循环播放的动画】【受击时播放的动画】 , 不写就不显示动画
Effect.AnimDelays=31                            ; 整数 , 每次播放【持有时循环播放的动画】的延迟时间 , 默认值是 31
Effect.AcceptBuffs=                             ; Buff 列表 , 拥有这些 Buff 时【伤害免疫】才能生效 (至少拥有一个才生效)
Effect.ExceptBuffs=                             ; Buff 列表 , 拥有这些 Buff 时【伤害免疫】不生效 , 如果两个列表都设置了就必须同时满足两个列表才行
Effect.Healths=-1,-1                            ; 两个浮点数 , 单位生命值的【生命值上限】和【生命值下限】 , 满足所有条件才能免疫伤害 , 负数 = 条件不生效 , 默认值是 -1
                                                ; 单位当前生命值比例 > 【生命值上限】或 < 【生命值下限】时免疫伤害 , 0.2 = 20% 的生命值
Effect.Power.Limits=-1,-1                       ; 两个浮点数 , 效果强度值的判断【效果强度值上限】和【效果强度值下限】 , 满足所有条件才能免疫伤害 , 负数 = 条件不生效 , 默认值是 -1
                                                ; 当前效果强度值 > 【效果强度值上限】或 < 【效果强度值下限】时免疫伤害 , 仅能判断正数的效果强度值
Effect.Counts=-1                                ; 整数 , 最多可以免疫伤害的次数 , 次数耗尽会立刻进入结束状态 , 等于 0 会无法生效并直接进入结束状态 (算作次数耗尽) , 负数 = 无限次 , 默认值是 -1 , 单位 : 次
Effect.Delay=0                                  ; 整数 , 每次免疫伤害后需要等待的时间 , 0 = 不限制 , 小于 0 按 0 算 , 默认值是 0 , 单位 : 帧
Effect.Owner=All                                ; 作战方归属 , 需要目标单位符合作战方
                                                ; 可用值 : All (无简写) , Self | S , Allies | A , Enemies | E , Neutral | N , 默认值是 All (不区分大小写)
                                                ; 当需要匹配多种作战方时 , 多个值之间使用 "," 符号连接即可 , 栗如同时匹配己方和敌方 : Self,Enemies 或 S,E (简写可以混用 , 不要有空格)
Effect.Modes=0                                  ; 整数 , 【影响伤害模式】 , 无效值默认为 0 , 默认值是 0
                                                ; 【影响伤害模式】
                                                ; 0 = 仅影响伤害
                                                ; 1 = 仅影响治疗
                                                ; 2 = 都影响
```

### 广播与监听相关属性

不支持广播或监听。

### 数值显示相关属性

不支持数值显示。



## 伤害闪避 <受伤，治疗>

位于 `rulesmd.ini`：

```ini
[SomeBuffType]
Effect.Type=DamageAvoid
```

可以按照一定概率闪避受到的伤害。

### 注意

* 0 伤害不参与闪避。

### 效果强度值转换：1 项参数

|参数|说明|
|:-:|:-|
|【闪避概率】|0.4 = 40% 的概率闪避，0 = 无法闪避并立刻进入结束状态，小于 0 按 0 算，默认值是 `0`。|

### 效果种类相关属性

位于 `rulesmd.ini`：

```ini
[SomeBuffType]
; 效果种类相关属性
Effect.Anims=                                   ; 两个动画 , 【成功闪避时播放的动画】【不成功时播放的动画】 , 不写就不显示动画
Effect.Counts=-1                                ; 整数 , 最多可以闪避的次数 (闪避失败也算) , 次数耗尽会立刻进入结束状态 , 等于 0 会无法生效并直接进入结束状态 (算作次数耗尽) , 负数 = 无限次 , 默认值是 -1 , 单位 : 次
Effect.Delay=0                                  ; 整数 , 每次闪避后需要等待的时间 (闪避失败也算) , 0 = 不限制 , 小于 0 按 0 算 , 默认值是 0 , 单位 : 帧
Effect.Modes=0                                  ; 整数 , 【影响伤害模式】 , 无效值默认为 0 , 默认值是 0
                                                ; 【影响伤害模式】
                                                ; 0 = 仅影响伤害
                                                ; 1 = 仅影响治疗
                                                ; 2 = 都影响
```

### 广播与监听相关属性

不支持广播或监听。

### 数值显示相关属性

不支持数值显示。



## 伤害延迟 <主动，受伤>

位于 `rulesmd.ini`：

```ini
[SomeBuffType]
Effect.Type=DamageDefer
```

受到攻击后，当次伤害会被免疫，这些伤害（数值）会被转换为对自己的持续伤害（使用另外的弹头）。  
`DamageProcessType` 属性有效。

### 注意

* 暂不支持使用被攻击时攻击单位使用的弹头。

* 由于是单位自己射自己，所以弹头需要设置 `AllowDamageOnSelf=yes` 才有伤害。

* 延迟的伤害无法被再次延迟，0 伤害和负伤害不参与延迟。

### 效果强度值转换：1 项参数

|参数|说明|
|:-:|:-|
|【原始伤害转换为持续伤害的比例】|0.4 = 有 40% 的原始伤害会被转换为持续伤害，其余部分正常结算，0 = 无法延迟伤害并立刻进入结束状态，小于 0 按 0 算，默认值是 `0`。|

### 效果种类相关属性

位于 `rulesmd.ini`：

```ini
[SomeBuffType]
; 效果种类相关属性
Effect.Anims=                                   ; 两个动画 , 【受到持续伤害时播放的动画】【被攻击时播放的动画】 , 不写就不显示动画
Effect.Warheads=                                ; 弹头 , 产生持续伤害时使用的弹头 , 不写或留空就使用 [BuffControls] -> Warhead 的弹头
Effect.Damages=1,1                              ; 两个整数 , 受到的伤害 > 【最大值】或 < 【最小值】时不会产生持续伤害而是直接结算 , 默认值是 1 , 单位 : 点
Effect.Counts=-1                                ; 整数 , 最多可以延迟伤害的次数 , 次数耗尽且没有剩余伤害时会立刻进入结束状态 , 等于 0 会无法生效并直接进入结束状态 , 负数 = 无限次 , 默认值是 -1 , 单位 : 次
Effect.Amounts=-1                               ; 整数 , 数值 = 最大次数结算 (见下) , 数值 = 最大值结算 (见下) , 默认值是 -1 , 单位 : 点
Effect.Delay=0                                  ; 整数 , 持续伤害的时间间隔 , 小于 0 按 0 算 , 但是每一帧最多结算一次 ,  , 默认值是 0 , 单位 : 帧
Effect.Modes=0,0                                ; 两个整数 , 【结算模式】【受伤后的延迟模式】 , 无效值默认为 0 , 默认值是 0
                                                ; 【结算模式】
                                                ; 0 = 最大次数结算 (见下)
                                                ; 1 = 最大值结算 (见下)
                                                ; 【受伤后的延迟模式】
                                                ; 0 = 不重置延迟计时
                                                ; 1 = 重置延迟计时 , 即受到新的伤害后 , Delay 重新计算 , 如果一直被打则可能不会受到延迟伤害
```

### 结算模式

* 最大次数结算

`Effect.Amounts` 属性定义的数值作为【最大次数】，负数或 0 = 无效并立刻进入结束状态。  
单位受到的伤害（数值）除以【最大次数】（向上取整）作为每经过【持续伤害的时间间隔】实际受到的【伤害量】，【伤害量】和【剩余结算次数】会被记录并储存在 Buff 中。  
单位再次受到伤害时，新的伤害（数值）会与【伤害量】*【剩余结算次数】的结果合并，并作为伤害数值除以【最大次数】再次得到新的【伤害量】。  
新的【伤害量】会覆盖原来的【伤害量】，且【剩余结算次数】会被重置为【最大次数】。

* 最大值结算

`Effect.Amounts` 属性定义的数值作为【最大值】，0 = 无效并立刻进入结束状态，负数 = 会出现单位被攻击后一直恢复生命值的效果（此情况下由于【伤害总量】无法耗尽，恢复生命值会一直持续）。  
单位受到的伤害（数值）会作为【伤害总量】被记录并储存在 Buff 中。  
每经过【持续伤害的时间间隔】，就会从【伤害总量】取出【最大值】这么多的伤害转变为实际受到的伤害。  
【伤害总量】不足时会尽可能的取出。

### 广播与监听相关属性

不支持广播或监听。

### 数值显示相关属性

不支持数值显示。



## 伤害限制 <受伤>

位于 `rulesmd.ini`：

```ini
[SomeBuffType]
Effect.Type=DamageLimit
```

可以设置受到的伤害的最大值和最小值，以及最高受伤的频率。

### 注意

* 0 伤害和负伤害不参与限制。

### 效果强度值转换：2 项参数

|参数|说明|
|:-:|:-|
|【允许的伤害上限】|-1 ~ 0 = 当前生命值比例（取绝对值），0 ~ 1 = 生命值上限的比例，大于 1 = 数值（整数），小于 -1 按 -1 算，默认值是 `0`，单位：点。|
|【允许的伤害下限】|-1 ~ 0 = 当前生命值比例（取绝对值），0 ~ 1 = 生命值上限的比例，大于 1 = 数值（整数），小于 -1 按 -1 算，默认值是 `0`，单位：点。|

### 效果种类相关属性

位于 `rulesmd.ini`：

```ini
[SomeBuffType]
; 效果种类相关属性
Effect.Anims=                                   ; 三个动画 , 【伤害被限制时播放的动画】【限制上限伤害时播放的动画】【限制下限伤害时播放的动画】 , 不写就不显示动画
Effect.Counts=-1                                ; 整数 , 最多可以限制伤害的次数 , 次数耗尽会立刻进入结束状态 , 等于 0 会无法生效并直接进入结束状态 (算作次数耗尽) , 负数 = 无限次 , 默认值是 -1 , 单位 : 次
Effect.Delay=0                                  ; 整数 , 每次受到伤害后多长时间内无法受到伤害 (免疫后续伤害) , 0 = 不限制 , 小于 0 按 0 算 , 默认值是 0 , 单位 : 帧
```

### 广播与监听相关属性

不支持广播或监听。

### 数值显示相关属性

不支持数值显示。



## 伤害增幅 <受伤，治疗>

位于 `rulesmd.ini`：

```ini
[SomeBuffType]
Effect.Type=DamageRatio
```

可以设置受到的伤害的增幅倍率的程度的能力。

### 注意

* 0 伤害不参与增幅。

### 效果强度值转换：1 项参数

|参数|说明|
|:-:|:-|
|【增幅倍率】|-1 = 无增幅，-0.2 = 80% 伤害，0 = 原始伤害，默认值是 `0`。|

### 效果种类相关属性

位于 `rulesmd.ini`：

```ini
[SomeBuffType]
; 效果种类相关属性
Effect.Timer=0                                  ; 整数 , 生效时间的最大值 , 超过时间限制会立刻进入结束状态 , 0 = 无限 , 小于 0 按 0 算 , 默认值是 0 , 单位 : 帧
Effect.Counts=-1                                ; 整数 , 最多可以增幅伤害的次数 , 次数耗尽会立刻进入结束状态 , 等于 0 会无法生效并直接进入结束状态 (算作次数耗尽) , 负数 = 无限次 , 默认值是 -1 , 单位 : 次
Effect.Delay=0                                  ; 整数 , 每次增幅伤害后多长时间内无法再次增幅 , 0 = 不限制 , 小于 0 按 0 算 , 默认值是 0 , 单位 : 帧
Effect.Modes=0,0,0,0,0,0                        ; 六个整数 , 【影响伤害模式】【影响分摊模式】【影响延迟模式】【影响反射模式】【影响连锁模式】【影响即死模式】 , 无效值默认为 0 , 默认值是 0
                                                ; 【影响伤害模式】
                                                ; 0 = 仅影响伤害
                                                ; 1 = 仅影响治疗
                                                ; 2 = 都影响
                                                ; 【影响分摊模式】
                                                ; 0 = 不影响【伤害分摊】造成的伤害
                                                ; 1 = 影响
                                                ; 【影响延迟模式】
                                                ; 0 = 不影响【伤害延迟】造成的伤害
                                                ; 1 = 影响
                                                ; 【影响反射模式】
                                                ; 0 = 不影响【伤害反射】造成的伤害
                                                ; 1 = 影响
                                                ; 【影响连锁模式】
                                                ; 0 = 不影响【伤害连锁】造成的伤害
                                                ; 1 = 影响
                                                ; 【影响即死模式】
                                                ; 0 = 不影响【伤害即死】造成的伤害
                                                ; 1 = 影响
```

### 广播与监听相关属性

不支持广播或监听。

### 数值显示相关属性

不支持数值显示。



## 伤害隔离 <受伤>

位于 `rulesmd.ini`：

```ini
[SomeBuffType]
Effect.Type=DamagePrevent
```

【伤害免疫】的另一种形式 , 当受到的伤害 (数值) 低于下限或高于上限时 (不含等于) , 免疫此伤害。

### 注意

* 0 伤害和负伤害不参与隔离。

### 效果强度值转换：2 项参数

|参数|说明|
|:-:|:-|
|【伤害上限】|-1 ~ 0 = 当前生命值比例（取绝对值），0 ~ 1 = 生命值上限的比例，大于 1 = 数值（在 Buff 效果处理过程内部，伤害可以是小数），小于 -1 按 -1 算，默认值是 `0`，单位：点。|
|【伤害下限】|-1 ~ 0 = 当前生命值比例（取绝对值），0 ~ 1 = 生命值上限的比例，大于 1 = 数值（在 Buff 效果处理过程内部，伤害可以是小数），小于 -1 按 -1 算，默认值是 `0`，单位：点。|

### 效果种类相关属性

位于 `rulesmd.ini`：

```ini
[SomeBuffType]
; 效果种类相关属性
Effect.Anims=                                   ; 两个动画 , 【隔离上限伤害时播放的动画】【隔离下限伤害时播放的动画】 , 不写就不显示动画
Effect.Counts=-1                                ; 整数 , 最多可以免疫伤害的次数 , 次数耗尽会立刻进入结束状态 , 等于 0 会无法生效并直接进入结束状态 (算作次数耗尽) , 负数 = 无限次 , 默认值是 -1 , 单位 : 次
Effect.Delay=0                                  ; 整数 , 每次免疫伤害后多长时间内无法再次免疫 , 0 = 不限制 , 小于 0 按 0 算 , 默认值是 0 , 单位 : 帧
```

### 广播与监听相关属性

不支持广播或监听。

### 数值显示相关属性

不支持数值显示。



## 伤害反射 <受伤，治疗>

位于 `rulesmd.ini`：

```ini
[SomeBuffType]
Effect.Type=DamageReflect
```

受到攻击时，对攻击者实行反击，`反射伤害 = 攻击实际造成的伤害 * 反射伤害倍率`，`实际受到的伤害 = 攻击实际造成的伤害 * 受伤比例`。  
`DamageProcessType` 属性有效。

### 注意

* 反射出的伤害无法被再次反射，0 伤害不参与反射。

### 效果强度值转换：3 项参数

|参数|说明|
|:-:|:-|
|【反射伤害倍率】|默认值是 `0`。|
|【受伤比例】|可以小于 0，默认值是 `0`。|
|【反射的概率】|-1 = 0%，-0.2 = 80%，0 = 100%，小于 -1 按 -1 算，默认值是 `0`。|

### 效果种类相关属性

位于 `rulesmd.ini`：

```ini
[SomeBuffType]
; 效果种类相关属性
Effect.Anims=                                   ; 三个动画 , 【反射成功时播放的动画】【反射失败时播放的动画】【反射目标身上播放的动画】 , 不写就不显示动画
Effect.Warheads=                                ; 弹头 , 反击时使用的弹头 , 没有弹头则使用攻击方的弹头
Effect.Counts=-1                                ; 整数 , 最多可以反射伤害的次数 , 次数耗尽会立刻进入结束状态 , 等于 0 会无法生效并直接进入结束状态 (算作次数耗尽) , 负数 = 无限次 , 默认值是 -1 , 单位 : 次
Effect.Delay=0                                  ; 整数 , 每次反射伤害后多长时间内无法再次反射 , 0 = 不限制 , 小于 0 按 0 算 , 默认值是 0 , 单位 : 帧
Effect.Range=0                                  ; 浮点数 , 攻击者必须在这个距离内才能反射伤害 , 0 = 不限制 , 小于 0 按 0 算 , 默认值是 0
Effect.Self=yes                                 ; yes/no , 是否反射自己对自己的伤害 , 默认值是 yes
Effect.Other=yes                                ; yes/no , 是否反射别人对自己的伤害 , 默认值是 yes
Effect.Source=no                                ; yes/no , 反射的伤害的来源是否为原始攻击单位 , 默认值是 no
                                                ; no = 相当于攻击者自己射自己 , 所以弹头需要设置 AllowDamageOnSelf=yes 才有伤害
Effect.Modes=0                                  ; 整数 , 【反射模式】 , 无效值默认为 0 , 默认值是 0
                                                ; 【反射模式】
                                                ; 0 = 反射给来源
                                                ; 1 = 反射给自己
                                                ; 2 = 一起吧 (先来源后自己)
                                                ; 3 = 一起吧 (先自己后来源)
```

### 广播与监听相关属性

不支持广播或监听。

### 数值显示相关属性

不支持数值显示。



## 伤害连锁 <受伤，治疗>

位于 `rulesmd.ini`：

```ini
[SomeBuffType]
Effect.Type=DamageLink
```

受到攻击时，会把一部分伤害传递给 Buff 来源单位（要求这个单位在地图上，非载员、非驻军等）。  
`DamageProcessType` 属性有效。

### 注意

* 伤害可以被免疫，而且就算没有伤害也仍旧会发射弹头。

* Buff 来源单位已死亡或不在地图上时，此效果种类不生效。

* 连锁产生的伤害无法再次触发伤害连锁，0 伤害不参与连锁。

### 效果强度值转换：4 项参数

|参数|说明|
|:-:|:-|
|【传递伤害的概率】|小于 0 按 0 算，默认值是 `0`。|
|【传递伤害的比例】|可以小于 0，默认值是 `0`。|
|【受伤比例】|可以小于 0，默认值是 `0`。|
|【引爆弹头的伤害】|默认值是 `0`，单位 : 点。|

### 效果种类相关属性

位于 `rulesmd.ini`：

```ini
[SomeBuffType]
; 效果种类相关属性
Effect.Anims=                                   ; 两个动画 , 【在自己身上播放的动画】【在目标身上播放的动画】 , 不写就不显示动画
Effect.Warheads=                                ; 弹头 , 连锁死亡使用的弹头 , 不写或留空就使用 [BuffControls] -> Warhead 的弹头
Effect.Timer=0                                  ; 整数 , 生效时间的最大值 , 超过时间限制会立刻进入结束状态 , 0 = 无限 , 小于 0 按 0 算 , 默认值是 0 , 单位 : 帧
Effect.Source=no                                ; yes/no , 连锁的伤害的来源是否为原始攻击单位 , 默认值是 no
Effect.Modes=0                                  ; 整数 , 【伤害模式】 , 无效值默认为 0 , 默认值是 0
                                                ; 【伤害模式】
                                                ; 0 = 直接造成伤害 (无弹头动画) , 伤害 = 【传递伤害的比例】为 0 则【引爆弹头的伤害】
                                                ; 1 = 引爆弹头 (结算护甲) , 伤害 = 【传递伤害的比例】为 0 则【引爆弹头的伤害】
```

### 广播与监听相关属性

不支持广播或监听。

### 数值显示相关属性

不支持数值显示。



## 伤害即死 <受伤>

位于 `rulesmd.ini`：

```ini
[SomeBuffType]
Effect.Type=DamageKill
```

受到攻击时，如果伤害 >= 0，则伤害会变得致命（变成当前生命值那么多）。

### 注意

* 伤害可以被免疫。

### 效果强度值转换：1 项参数

|参数|说明|
|:-:|:-|
|【受到致命伤害的概率】|触发一次后会立刻进入结束状态，不管是否成功（作战方归属不匹配时不算触发），0.2 = 20%，小于 0 按 0 算，默认值是 `0`。|

### 效果种类相关属性

位于 `rulesmd.ini`：

```ini
[SomeBuffType]
; 效果种类相关属性
Effect.Anims=                                   ; 两个动画 , 【目标死亡成功时播放的动画】【目标死亡失败时播放的动画】 , 不写就不显示动画
Effect.Timer=0                                  ; 整数 , 生效时间的最大值 , 超过时间限制会立刻进入结束状态 , 0 = 无限 , 小于 0 按 0 算 , 默认值是 0 , 单位 : 帧
Effect.Owner=All                                ; 作战方归属 , 需要目标单位符合作战方
                                                ; 可用值 : All (无简写) , Self | S , Allies | A , Enemies | E , Neutral | N , 默认值是 All (不区分大小写)
                                                ; 当需要匹配多种作战方时 , 多个值之间使用 "," 符号连接即可 , 栗如同时匹配己方和敌方 : Self,Enemies 或 S,E (简写可以混用 , 不要有空格)
```

### 广播与监听相关属性

不支持广播或监听。

### 数值显示相关属性

不支持数值显示。



## 伤害免死 <受伤>

位于 `rulesmd.ini`：

```ini
[SomeBuffType]
Effect.Type=DamageRefuse
```

处理这个效果种类的 Buff 时，如果当前伤害可以使单位死亡（不考虑后续的处理），则会免疫此次伤害。  
`DamageProcessType` 属性无效。

### 注意

* 由于不考虑后续的处理（后续的处理可能导致伤害变低从而打不死单位），因此要保证伤害确实可以击杀单位的话，就需要这个 Buff 的处理顺序非常靠后。  
以及另一种情况，免死后仍然可能由于后续的处理导致伤害过高从而击杀单位。

* 触发后，先挂载 Buff，后引爆弹头。

### 效果强度值转换：1+M+N 项参数

|参数|说明|
|:-:|:-|
|【抵挡致命伤害的概率】|受到足够大的伤害时才会触发，不管是否成功都消耗次数（作战方归属不匹配时不算触发），0.2 = 20%，小于 0 按 0 算，默认值是 `0`。|

后续的 M 个参数项数与 `Effect.AcceptBuffs` 的长度相匹配。  
每一项都是【挂载持续时间】：  
从第 1 个 Buff 开始（索引 0），单位的 Buff 抗性有效，会改变最终附加的挂载持续时间，附加后的挂载持续时间会被【实际数值的上下限】限制，默认值是 `0`，单位：帧。  
根据目标单位是否拥有指定的 Buff，会有不同的细节效果：

1. 如果目标单位没有指定的 Buff，则挂载此 Buff，挂载者为当前 Buff 的持有者，负数 = 永久，0 = 使用 Buff 的默认值。

2. 如果目标单位已有指定的 Buff，则延长此 Buff 的挂载持续时间，负数 = 倒扣挂载持续时间，0 = 没作用。

在此处：  
`Power.Maxs.Total` 对应项的值，其中 0 = 使用 Buff 的 `Duration.Max` 的值；  
`Power.Mins.Total` 对应项的值，其中 0 = 使用 Buff 的 `Duration.Min` 的值。

后续的 N 个参数项数与 `Effect.Warheads` 的长度相匹配。  
每一项都是【对应每个弹头的伤害】：  
从第 1 个弹头开始（索引 0），0 = 没伤害，负数 = 治疗，默认值是 `0`。

### 效果种类相关属性

位于 `rulesmd.ini`：

```ini
[SomeBuffType]
; 效果种类相关属性
Effect.Anims=                                   ; 动画 , 【受到致命伤害时播放的动画】 , 不写就不显示动画
Effect.AcceptBuffs=                             ; Buff 列表 , 挂载这些 Buff , 没设置就不挂载
Effect.Warheads=                                ; 弹头列表 , 没有弹头就炸不出来
Effect.Timer=0                                  ; 整数 , 生效时间的最大值 , 超过时间限制会立刻进入结束状态 , 0 = 无限 , 小于 0 按 0 算 , 默认值是 0 , 单位 : 帧
Effect.Counts=-1                                ; 整数 , 最多可以触发的次数 , 次数耗尽会立刻进入结束状态 , 等于 0 会无法生效并直接进入结束状态 (算作次数耗尽) , 负数 = 无限次 , 默认值是 -1 , 单位 : 次
Effect.Delay=0                                  ; 整数 , 每次触发后多长时间内无法再次触发 , 0 = 不限制 , 小于 0 按 0 算 , 默认值是 0 , 单位 : 帧
Effect.Amounts=-1,-1                            ; 两个整数 , 【引爆的弹头数量】【Buff 和弹头的触发时间间隔】 , 默认值是 -1
                                                ; 【引爆的弹头数量】 , 负数 = 全炸一遍 , 0 = 炸不出来 , 单位 : 个
                                                ; 【Buff 和弹头的触发时间间隔】 , 负数 = 只触发 1 次且值为初始冷却时间 (绝对值) , 0 = 不限制 , 单位 : 帧
Effect.Random=no                                ; yes/no , 不全部引爆时 , 是否随机选择弹头 , 不随机则从第一个一直炸到最后一个 , 然后再回到第一个 (永远从第一个弹头开始 , 引爆数量够多可以全炸好几遍) , 默认值是 no
Effect.Owner=All                                ; 作战方归属 , 需要目标单位符合作战方
                                                ; 可用值 : All (无简写) , Self | S , Allies | A , Enemies | E , Neutral | N , 默认值是 All (不区分大小写)
                                                ; 当需要匹配多种作战方时 , 多个值之间使用 "," 符号连接即可 , 栗如同时匹配己方和敌方 : Self,Enemies 或 S,E (简写可以混用 , 不要有空格)
Effect.Modes=0                                  ; 整数 , 【血量控制模式】 , 无效值默认为 0 , 默认值是 0
                                                ; 【血量控制模式】
                                                ; 0 = 剩余 1 生命值
                                                ; 1 = 此次伤害归 0 , 即不会受到伤害
```

### 广播与监听相关属性

不支持广播或监听。

### 数值显示相关属性

不支持数值显示。